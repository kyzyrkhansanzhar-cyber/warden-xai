import re

def warden_scan(text):
    # 1. Ğ¢ĞµĞºÑĞµÑ€ĞµÑ‚Ñ–Ğ½ ÑÓ©Ğ·Ğ´ĞµÑ€ Ñ‚Ñ–Ğ·Ñ–Ğ¼Ñ– (Ğ‘Ğ°Ñ€Ğ»Ñ‹Ò› Ğ½Ò±ÑÒ›Ğ°Ğ»Ğ°Ñ€Ñ‹Ğ¼ĞµĞ½)
    keywords = [
        'Ò±Ñ‚Ñ‹Ñ', 'ÑƒÑ‚Ñ‹Ñ', 'ÑÑ‹Ğ¹Ğ»Ñ‹Ò›', 'ÑÑ‹Ğ¹Ğ»Ñ‹Ğº', 'Ğ°ĞºÑ†Ğ¸Ñ', 'Ñ‚ĞµĞ³Ñ–Ğ½', 'Ñ‚ĞµĞ³Ğ¸Ğ½', 
        'Ñ‚ĞµÒ£Ğ³Ğµ', 'Ñ‚ĞµĞ½Ğ³Ğµ', 'Ğ¶Ò¯Ğ»Ğ´Ğµ', 'Ğ¶ÑƒĞ»Ğ´Ğµ', 'Ò±Ñ‚Ñ‚Ñ‹Ò£Ñ‹Ğ·', 'ÑƒÑ‚Ñ‚Ñ‹Ğ½Ñ‹Ğ·', 'ÑƒÑ‚Ñ‹Ğ¿',
        'Ğ°Ğ»Ğ´Ñ‹Ò£Ñ‹Ğ·', 'Ğ°Ğ»Ğ´Ñ‹Ğ½Ñ‹Ğ·', 'Ğ°Ò›ÑˆĞ°', 'Ğ°ĞºÑˆĞ°'
    ]
    
    # 2. ĞšÒ¯Ğ¼Ó™Ğ½Ğ´Ñ– ÑÑ–Ğ»Ñ‚ĞµĞ¼ĞµĞ»ĞµÑ€ (Ğ´Ğ¾Ğ¼ĞµĞ½Ğ´ĞµÑ€)
    suspicious_domains = ['.tk', '.xyz', '.ga', '.cf', '.ml', 'bit.ly', 'tinyurl']
    
    alerts = []
    score = 0
    text_lower = text.lower()

    # Ğ¡Ó©Ğ·Ğ´ĞµÑ€Ğ´Ñ– Ñ‚ĞµĞºÑĞµÑ€Ñƒ
    for word in keywords:
        if word in text_lower:
            alerts.append(f"Ğ¢Ğ°Ğ±Ñ‹Ğ»Ğ´Ñ‹: ĞšÒ¯Ğ¼Ó™Ğ½Ğ´Ñ– ÑÓ©Ğ· '{word}'")
            score += 25

    # Ğ¡Ñ–Ğ»Ñ‚ĞµĞ¼ĞµĞ»ĞµÑ€Ğ´Ñ– Ñ‚ĞµĞºÑĞµÑ€Ñƒ
    for domain in suspicious_domains:
        if domain in text_lower:
            alerts.append("Ğ¢Ğ°Ğ±Ñ‹Ğ»Ğ´Ñ‹: Ğ¡Ò±Ñ€Ğ°Ò› Ñ‚ÑƒÒ“Ñ‹Ğ·Ğ°Ñ‚Ñ‹Ğ½ ÑÑ–Ğ»Ñ‚ĞµĞ¼Ğµ")
            score += 40
            break

    # Ğ­Ğ¼Ğ¾Ğ´Ğ·Ğ¸Ğ»ĞµÑ€Ğ´Ñ– Ñ‚ĞµĞºÑĞµÑ€Ñƒ
    if any(emoji in text for emoji in ['ğŸ', 'ğŸ’°', 'ğŸš¨', 'ğŸ’¸']):
        alerts.append("Ğ¢Ğ°Ğ±Ñ‹Ğ»Ğ´Ñ‹: ĞšÒ¯Ğ¼Ó™Ğ½Ğ´Ñ– ÑĞ¼Ğ¾Ğ´Ğ·Ğ¸Ğ»ĞµÑ€")
        score += 15

    # ĞÓ™Ñ‚Ğ¸Ğ¶ĞµĞ½Ñ– Ò›Ğ¾Ñ€Ñ‹Ñ‚Ñ‹Ğ½Ğ´Ñ‹Ğ»Ğ°Ñƒ
    score = min(score, 100) # ĞœĞ°ĞºÑĞ¸Ğ¼ÑƒĞ¼ 100%
    
    if score >= 70:
        status = "ğŸ”´ ÒšĞĞ£Ğ†ĞŸĞ¢Ğ†"
    elif score >= 30:
        status = "ğŸŸ¡ ĞšÒ®ĞœÓ˜ĞĞ”Ğ†"
    else:
        status = "ğŸŸ¢ Ğ¢ĞĞ—Ğ"

    return {
        "status": status,
        "score": score,
        "alerts": alerts
    }